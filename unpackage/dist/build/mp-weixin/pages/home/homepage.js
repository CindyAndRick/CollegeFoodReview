(global["webpackJsonp"]=global["webpackJsonp"]||[]).push([["pages/home/homepage"],{"0da7":function(t,e,o){"use strict";o.d(e,"b",(function(){return i})),o.d(e,"c",(function(){return a})),o.d(e,"a",(function(){return n}));var n={uniIcons:function(){return Promise.all([o.e("common/vendor"),o.e("uni_modules/uni-icons/components/uni-icons/uni-icons")]).then(o.bind(null,"d7ac"))},uniCard:function(){return o.e("uni_modules/uni-card/components/uni-card/uni-card").then(o.bind(null,"1a0f"))},uniLoadMore:function(){return Promise.all([o.e("common/vendor"),o.e("uni_modules/uni-load-more/components/uni-load-more/uni-load-more")]).then(o.bind(null,"b4b9"))},commentInput:function(){return o.e("uni_modules/qizai9527-input-comment/components/commentInput/commentInput").then(o.bind(null,"1abf"))}},i=function(){var t=this,e=t.$createElement,o=(t._self._c,t.__map(t.commentList,(function(e,o){var n=t.__get_orig(e),i=t.getTime(e.time);return{$orig:n,m0:i}})));t.$mp.data=Object.assign({},{$root:{l0:o}})},a=[]},"0ecc":function(t,e,o){},2733:function(t,e,o){"use strict";(function(t){Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var o={data:function(){return{myId:"",id:"",tempIdentity:"",avatarUrl:"",nickName:"",identity:"",status:"",authority:"",followerNum:"",followingNum:"",favouredStoreNum:"",isFriend:"",isFollow:"",remark:"",followingList:[],commentList:[],favouredStoreList:[],followerList:[],isShowComment:!1,placeholder:"发个友善的评论吧",tmpCommentData:[],curCommentId:"",curtoId:"",contenDown:{contentnomore:"没有更多评论啦"}}},onShow:function(){var t=this;t.refresh()},onLoad:function(t){var e=this;this.id=t.id,console.log("当前页面用户id："+this.id),e.refresh()},methods:{checkTime:function(t){return t<10&&(t="0"+t),t},getTime:function(t){var e=new Date(1*t),o=e.getFullYear(),n=e.getMonth()+1,i=e.getDate(),a=(e.getDay(),e.getHours()),d=e.getMinutes(),s=e.getSeconds();a=this.checkTime(a),d=this.checkTime(d),s=this.checkTime(s);return o+"-"+n+"-"+i+" "+a+":"+d+":"+s},refresh:function(){var e=this,o=this;t.getStorage({key:"userInfo",success:function(e){console.log(e.data),o.myId=e.data.id,o.identity=o.id==o.myId?1:2,1==o.identity?(o.avatarUrl=e.data.avatarUrl,o.nickName=e.data.nickName,o.status="1"==e.data.status,o.followerNum=e.data.followerNum,o.followingNum=e.data.followingNum,o.favouredStoreNum=e.data.favouredStoreNum,t.request({url:"http://124.71.170.100/index.php/index/getFollowerNum",method:"GET",data:{id:o.myId},success:function(t){o.followerNum=t.data.data.followerNum,console.log(t),console.log("获取粉丝成功")},fail:function(){console.log("获取粉丝失败")}})):2==o.identity&&(t.request({url:"http://124.71.170.100/index.php/index/getOtherUserInfo",method:"GET",data:{otherUserId:o.id,id:o.myId},success:function(t){console.log("获取用户信息成功"),o.avatarUrl=t.data.data.avatarUrl,o.nickName=t.data.data.nickName,o.status="1"==t.data.data.status,o.followerNum=t.data.data.followerNum,o.followingNum=t.data.data.followingNum,o.favouredStoreNum=t.data.data.favouredStoreNum,o.isFriend=t.data.data.isFriend,o.isFollow=t.data.data.isFollow,o.remark=t.data.data.remark},fail:function(){console.log("获取用户信息失败")}}),t.request({url:"http://124.71.170.100/index.php/index/getUserIdentity",method:"GET",data:{id:o.myId},success:function(t){console.log("获取身份成功"),console.log(t),o.tempIdentity=t.data.data.identity,console.log(o.tempIdentity)},fail:function(){console.log("获取身份失败")}}))}}),t.request({url:"http://124.71.170.100/index.php/index/getCommentList",method:"GET",data:{id:this.id,userId:this.myId},success:function(t){console.log("获取评论成功"),console.log(t),e.commentList=t.data.data.commentList},fail:function(){console.log("获取评论失败")}}),t.request({url:"http://124.71.170.100/index.php/index/getAuthority",method:"GET",data:{id:this.id},success:function(t){console.log("获取权限成功"),console.log(t),e.authority="1"==t.data.data.authority,console.log(e.authority)},fail:function(){console.log("获取权限失败")}})},navigateBack:function(e){t.navigateBack({url:e})},editRemark:function(){t.navigateTo({url:"/pages/home/edit-remark?myId="+this.myId+"&id="+this.id+"&nickName="+this.nickName+"&remark="+this.remark})},followListClick:function(){t.navigateTo({url:"/pages/home/follows?id="+this.id})},fansClick:function(){t.navigateTo({url:"/pages/home/followers?id="+this.id})},favouredStoreClick:function(){t.navigateTo({url:"/pages/home/love-stores?id="+this.id})},editInfo:function(){t.navigateTo({url:"/pages/home/edit-info?id="+this.myId+"&avatarUrl="+this.avatarUrl+"&nickName="+this.nickName})},addFriend:function(){t.navigateTo({url:"/pages/home/add-friend?myId="+this.myId+"&id="+this.id+"&nickName="+this.nickName})},followClick:function(){var e=this;0==this.isFollow?(this.isFollow=1,t.request({url:"http://124.71.170.100/index.php/index/followUser",method:"POST",header:{"content-type":"application/json"},data:{id:this.myId,otherUserId:this.id},success:function(){console.log("关注用户成功"),e.followerNum++,t.getStorage({key:"userInfo",success:function(e){t.setStorage({key:"userInfo",data:{id:e.data.id,nickName:e.data.nickName,identity:e.data.identity,status:e.data.status,schoolName:e.data.schoolName,schoolId:e.data.schoolId,avatarUrl:e.data.avatarUrl,favouredStoreNum:e.data.favouredStoreNum,followerNum:e.data.followerNum,followingNum:e.data.followingNum+1}})}})}})):0!=this.isFollow&&(this.isFollow=0,t.request({url:"http://124.71.170.100/index.php/index/cancelFollowUser",method:"POST",header:{"content-type":"application/json"},data:{id:this.myId,otherUserId:this.id},success:function(){console.log("取消关注"),e.followerNum--,t.getStorage({key:"userInfo",success:function(e){t.setStorage({key:"userInfo",data:{id:e.data.id,nickName:e.data.nickName,identity:e.data.identity,status:e.data.status,schoolName:e.data.schoolName,schoolId:e.data.schoolId,avatarUrl:e.data.avatarUrl,favouredStoreNum:e.data.favouredStoreNum,followerNum:e.data.followerNum,followingNum:e.data.followingNum-1}})}})}}))},chat:function(){t.navigateTo({url:"/pages/message/chat?id="+this.myId+"&otherUserId="+this.id})},tipof:function(){t.navigateTo({url:"/pages/home/tip-of?id="+this.id+"&nickName="+this.nickName}),console.log("发送id: "+this.id)},switchChange:function(e){var o=this;this.authority=e.detail.value;var n=1==this.authority?"1":"0";t.request({url:"http://124.71.170.100/index.php/index/authorize",method:"POST",header:{"content-type":"application/x-www-form-urlencoded"},data:{id:this.myId,authority:n},success:function(t){console.log(t),console.log(o.myId),console.log(n)}})},toHomePage:function(e){var o,n=this;console.log("Id:"+e),t.request({url:"http://124.71.170.100/index.php/index/getUserIdentity",method:"GET",data:{id:e},success:function(i){console.log(i),o=i.data.data.identity,console.log(o),"1"==o?e!=n.id&&t.navigateTo({url:"/pages/home/homepage?id="+e}):"2"==o?t.navigateTo({url:"/pages/index/store?id="+e}):"0"==o&&t.showToast({title:"此用户为管理员",icon:"none",duration:1500})},fail:function(){console.log("获取身份失败")}})},dishClick:function(e){t.navigateTo({url:"/pages/index/dish?dishId="+this.commentList[e].dishId+"&isCanteen="+this.commentList[e].isCanteen})},hasLikedClick:function(e){this.commentList[e].isLiked=0,this.commentList[e].likedNum--,t.request({url:"http://124.71.170.100/index.php/index/likeComment",method:"POST",header:{"content-type":"application/w-xxx-form-unlencoded"},data:{commentId:this.commentList[e].commentId,id:this.myId},success:function(){console.log("取消点赞")}})},likedClick:function(e){this.commentList[e].isLiked=1,this.commentList[e].likedNum++,t.request({url:"http://124.71.170.100/index.php/index/likeComment",method:"POST",header:{"content-type":"application/w-xxx-form-unlencoded"},data:{commentId:this.commentList[e].commentId,id:this.myId},success:function(){console.log("点赞成功")}})},clickComment:function(t,e){this.isShowComment=!0,this.curCommentId=t,this.curtoId=e},submitComment:function(e){var o=this;t.request({url:"http://124.71.170.100/index.php/index/replyToComment",method:"POST",header:{"content-type":"application/json"},data:{commentId:this.curCommentId,fromId:this.myId,detail:e,toId:this.curtoId},success:function(){console.log(o.curCommentId),console.log(o.myId),console.log(e),console.log(o.curtoId),o.isShowComment=!1,o.refresh()}})},clickOther:function(t){this.isShowComment=!1},tipofClick:function(e){console.log("举报"),t.navigateTo({url:"/pages/home/tip-of-comment?commentId="+this.commentList[e].commentId})},deleteClick:function(e){var o=this;t.showModal({title:"确认撤回该评论？",success:function(n){n.confirm?(t.request({url:"http://124.71.170.100/index.php/index/deleteComment",method:"POST",header:{"content-type":"application/x-www-form-urlencoded"},data:{commentId:o.commentList[e].commentId,id:o.myId},success:function(){console.log("删除成功,评论Id为"+o.commentList[e].commentId)}}),o.refresh()):n.cancel&&console.log("取消删除")}})},toSpecific:function(e){console.log(e),console.log(this.commentList[e].commentId),t.navigateTo({url:"/pages/index/comment?commentId="+this.commentList[e].commentId+"&isCanteen="+this.commentList[e].isCanteen})},previewImg:function(e){var o=[];o[0]=e,t.previewImage({current:0,urls:o})}}};e.default=o}).call(this,o("543d")["default"])},"2c05":function(t,e,o){"use strict";var n=o("0ecc"),i=o.n(n);i.a},"50e2":function(t,e,o){"use strict";(function(t){o("4a2a");n(o("66fd"));var e=n(o("e921"));function n(t){return t&&t.__esModule?t:{default:t}}wx.__webpack_require_UNI_MP_PLUGIN__=o,t(e.default)}).call(this,o("543d")["createPage"])},6683:function(t,e,o){"use strict";o.r(e);var n=o("2733"),i=o.n(n);for(var a in n)"default"!==a&&function(t){o.d(e,t,(function(){return n[t]}))}(a);e["default"]=i.a},e921:function(t,e,o){"use strict";o.r(e);var n=o("0da7"),i=o("6683");for(var a in i)"default"!==a&&function(t){o.d(e,t,(function(){return i[t]}))}(a);o("2c05");var d,s=o("f0c5"),c=Object(s["a"])(i["default"],n["b"],n["c"],!1,null,null,null,!1,n["a"],d);e["default"]=c.exports}},[["50e2","common/runtime","common/vendor"]]]);