(global["webpackJsonp"]=global["webpackJsonp"]||[]).push([["pages/index/comment"],{"41b9":function(e,t,n){"use strict";(function(e){n("4a2a");o(n("66fd"));var t=o(n("7fa2"));function o(e){return e&&e.__esModule?e:{default:e}}wx.__webpack_require_UNI_MP_PLUGIN__=n,e(t.default)}).call(this,n("543d")["createPage"])},"7e55":function(e,t,n){"use strict";n.d(t,"b",(function(){return i})),n.d(t,"c",(function(){return a})),n.d(t,"a",(function(){return o}));var o={uniCard:function(){return n.e("uni_modules/uni-card/components/uni-card/uni-card").then(n.bind(null,"1a0f"))},uniIcons:function(){return Promise.all([n.e("common/vendor"),n.e("uni_modules/uni-icons/components/uni-icons/uni-icons")]).then(n.bind(null,"d7ac"))},commentInput:function(){return n.e("uni_modules/qizai9527-input-comment/components/commentInput/commentInput").then(n.bind(null,"1abf"))}},i=function(){var e=this,t=e.$createElement,n=(e._self._c,e.getTime(e.time));e.$mp.data=Object.assign({},{$root:{m0:n}})},a=[]},"7fa2":function(e,t,n){"use strict";n.r(t);var o=n("7e55"),i=n("dbbd");for(var a in i)"default"!==a&&function(e){n.d(t,e,(function(){return i[e]}))}(a);n("a83a");var d,c=n("f0c5"),s=Object(c["a"])(i["default"],o["b"],o["c"],!1,null,null,null,!1,o["a"],d);t["default"]=s.exports},a42c:function(e,t,n){"use strict";(function(e){Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var n={data:function(){return{isCanteen:"",myId:"",commentId:"",userId:"",nickName:"",remark:"",avatarUrl:"",dishId:"",dishName:"",merchantNickName:"",time:"",score:"",content:"",likedNum:"",likedList:[],isLiked:"",responseList:[],isShowComment:!1,placeholder:"发个友善的评论吧",tmpCommentData:[],curCommentId:"",curtoId:""}},onLoad:function(t){this.commentId=t.commentId,this.isCanteen=t.isCanteen;var n=this;e.getStorage({key:"userInfo",success:function(e){console.log(e.data),n.myId=e.data.id,n.refresh()}})},methods:{checkTime:function(e){return e<10&&(e="0"+e),e},getTime:function(e){var t=new Date(1*e),n=t.getFullYear(),o=t.getMonth()+1,i=t.getDate(),a=(t.getDay(),t.getHours()),d=t.getMinutes(),c=t.getSeconds();a=this.checkTime(a),d=this.checkTime(d),c=this.checkTime(c);return n+"-"+o+"-"+i+" "+a+":"+d+":"+c},refresh:function(){var t=this;e.request({url:"http://124.71.170.100/index.php/index/getDetailedResponseList",method:"GET",data:{commentId:this.commentId,id:this.myId},success:function(e){console.log(t.commentId),console.log(t.myId),console.log(e),t.userId=e.data.data.userId,t.nickName=e.data.data.nickName,t.remark=e.data.data.remark,t.avatarUrl=e.data.data.avatarUrl,t.dishId=e.data.data.dishId,t.dishName=e.data.data.dishName,t.merchantNickName=e.data.data.merchantNickName,t.time=e.data.data.time,t.score=e.data.data.score,t.content=e.data.data.content,t.likedList=e.data.data.likedList,t.likedNum=t.likedList.length,t.isLiked=e.data.data.isLiked,t.responseList=e.data.data.responseList,console.log("刷新成功")},fail:function(){console.log("刷新失败")}})},onClick:function(t){var n,o=this;"title"==t&&e.request({url:"http://124.71.170.100/index.php/index/getUserIdentity",method:"GET",data:{id:this.userId},success:function(t){console.log(t),n=t.data.data.identity,console.log(n),"1"==n?e.navigateTo({url:"/pages/home/homepage?id="+o.userId}):"2"==n&&e.navigateTo({url:"/pages/index/store?id="+o.userId})},fail:function(){console.log("获取身份失败")}})},toHomePage:function(t){var n;console.log("Id:"+t),e.request({url:"http://124.71.170.100/index.php/index/getUserIdentity",method:"GET",data:{id:t},success:function(o){console.log(o),n=o.data.data.identity,console.log(n),"1"==n?e.navigateTo({url:"/pages/home/homepage?id="+t}):"2"==n?e.navigateTo({url:"/pages/index/store?id="+t}):"0"==n&&e.showToast({title:"此用户为管理员",icon:"none",duration:1500})},fail:function(){console.log("获取身份失败")}})},hasLikedClick:function(){var t=this;this.isLiked=0,this.likedNum--,e.request({url:"http://124.71.170.100/index.php/index/likeComment",method:"POST",header:{"content-type":"application/w-xxx-form-unlencoded"},data:{commentId:this.commentId,id:this.myId},success:function(){console.log("取消点赞"),t.refresh()}})},likedClick:function(t){var n=this;this.isLiked=1,this.likedNum++,e.request({url:"http://124.71.170.100/index.php/index/likeComment",method:"POST",header:{"content-type":"application/w-xxx-form-unlencoded"},data:{commentId:this.commentId,id:this.myId},success:function(){console.log("点赞成功"),n.refresh()}})},clickComment:function(e,t){this.isShowComment=!0,this.curCommentId=e,this.curtoId=t},submitComment:function(t){var n=this;e.request({url:"http://124.71.170.100/index.php/index/replyToComment",method:"POST",header:{"content-type":"application/json"},data:{commentId:this.curCommentId,fromId:this.myId,detail:t,toId:this.curtoId},success:function(){console.log(n.curCommentId),console.log(n.myId),console.log(t),console.log(n.curtoId),n.isShowComment=!1,n.refresh()}})},clickOther:function(e){this.isShowComment=!1},tipofClick:function(){console.log("举报"),e.navigateTo({url:"/pages/home/tip-of-comment?commentId="+this.commentId+"&id="+this.userId})},deleteClick:function(){var t=this;e.showModal({title:"确认撤回该评论？",success:function(n){n.confirm?(e.request({url:"http://124.71.170.100/index.php/index/deleteComment",method:"POST",header:{"content-type":"application/x-www-form-urlencoded"},data:{commentId:t.commentId,id:t.myId},success:function(){console.log("删除成功,评论Id为"+t.commentId)}}),t.refresh()):n.cancel&&console.log("取消删除")}})},dishClick:function(){e.navigateTo({url:"/pages/index/dish?dishId="+this.dishId+"&isCanteen="+this.isCanteen})}}};t.default=n}).call(this,n("543d")["default"])},a83a:function(e,t,n){"use strict";var o=n("e261"),i=n.n(o);i.a},dbbd:function(e,t,n){"use strict";n.r(t);var o=n("a42c"),i=n.n(o);for(var a in o)"default"!==a&&function(e){n.d(t,e,(function(){return o[e]}))}(a);t["default"]=i.a},e261:function(e,t,n){}},[["41b9","common/runtime","common/vendor"]]]);