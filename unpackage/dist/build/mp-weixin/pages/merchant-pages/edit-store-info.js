(global["webpackJsonp"]=global["webpackJsonp"]||[]).push([["pages/merchant-pages/edit-store-info"],{"11e7":function(t,e,a){"use strict";a.r(e);var o=a("fa45"),s=a("d6e9");for(var n in s)"default"!==n&&function(t){a.d(e,t,(function(){return s[t]}))}(n);a("b681");var r,i=a("f0c5"),u=Object(i["a"])(s["default"],o["b"],o["c"],!1,null,null,null,!1,o["a"],r);e["default"]=u.exports},"565c":function(t,e,a){},"57e8":function(t,e,a){"use strict";(function(t){a("4a2a");o(a("66fd"));var e=o(a("11e7"));function o(t){return t&&t.__esModule?t:{default:t}}wx.__webpack_require_UNI_MP_PLUGIN__=a,t(e.default)}).call(this,a("543d")["createPage"])},"5c11":function(t,e,a){"use strict";(function(t){Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var a={data:function(){return{schoolNames:[],schoolIds:[],userInfo:{},storeData:{name:"",avatar:[],school:"",address:"",telephone:"",intro:"",categoryList:[],tmp_categoryList:[],images:[],tmp_images:[]},categoryLists:[],customRules:{name:{rules:[{required:!0,errorMessage:"商家名称不能为空"}]},school:{rules:[{required:!0,errorMessage:"学校不能为空"}]},address:{rules:[{required:!0,errorMessage:"商家地址不能为空"}]},telephone:{rules:[{required:!0,errorMessage:"联系电话不能为空"}]},introduction:{rules:[{required:!0,errorMessage:"商家介绍不能为空"}]}}}},onLoad:function(e){var a=this,o=this;t.getStorage({key:"userInfo",success:function(t){o.userInfo=t.data,o.storeData.school=t.data.schoolName}}),t.request({url:"http://124.71.170.100/index.php/index/getSchoolList",method:"GET",success:function(t){console.log("获取学校列表",t);for(var e=0;e<t.data.data.schoolList.length;e++)a.schoolNames.push(t.data.data.schoolList[e].schoolName),a.schoolIds.push(t.data.data.schoolList[e].schoolId)}}),t.request({url:"http://124.71.170.100/index.php/index/getCategory",method:"GET",success:function(o){console.log("获取分类列表",o.data.data.TotalCategoryList);for(var s=o.data.data.TotalCategoryList.length,n=0;n<s;n++){var r=new Object;r.text=o.data.data.TotalCategoryList[n],r.value=n,a.categoryLists.push(r)}t.request({url:"http://124.71.170.100/index.php/index/getStoreInfo",data:{id:e.id},method:"GET",success:function(t){if(console.log("获取商家当前信息成功"+JSON.stringify(t)),console.log("获得code "+t.data.code),""!=t.data.data.avatarUrl){var e={url:t.data.data.avatarUrl};a.storeData.avatar.push(e)}a.storeData.name=t.data.data.nickName,a.storeData.address=t.data.data.address,a.storeData.telephone=t.data.data.tel,a.storeData.intro=t.data.data.intro,console.log("获得商家名称 "+a.storeData.name),console.log("获得商家地址 "+a.storeData.address),console.log("获得商家联系方式 "+a.storeData.telephone),console.log("获得商家介绍 "+a.storeData.intro),a.storeData.tmp_images=t.data.data.pictureList,console.log("图片地址 "+a.storeData.images),console.log("获取分类列表"+t.data.data.categoryList),a.storeData.tmp_categoryList=t.data.data.categoryList;for(var o=0;o<t.data.data.categoryList.length;o++)for(var s=0;s<a.categoryLists.length;s++)if(t.data.data.categoryList[o]==a.categoryLists[s].text){a.storeData.categoryList.push(a.categoryLists[s].value);break}for(var n=0;n<t.data.data.pictureList.length;n++){var r={url:t.data.data.pictureList[n]};a.storeData.images.push(r)}}})}})},onShow:function(){wx.hideHomeButton()},methods:{submit:function(e,a){var o=this;null!=this.storeData.avatar&&0!=this.storeData.avatar.length&&this.$refs[e].validate().then((function(e){console.log("success",e),t.request({url:"http://124.71.170.100/index.php/index/editInfo",method:"POST",header:{"content-type":"application/json"},data:{nickName:o.storeData.name,id:o.userInfo.id,avatarUrl:null==o.storeData.avatar||0==o.storeData.avatar.length?"":o.storeData.avatar[0].url,categoryList:o.storeData.tmp_categoryList,address:o.storeData.address,tel:o.storeData.telephone,intro:o.storeData.intro,pictureList:o.storeData.tmp_images,isCanteen:"0",schoolName:o.storeData.school},success:function(e){console.log(e),t.reLaunch({url:"./store-homepage"}),t.showToast({title:"提交成功",mask:!0})}})})).catch((function(t){console.log("err",t)}))},selectImage:function(t){var e=this;console.log("选择图片",t),e.storeData.images=[];for(var a=0;a<e.storeData.tmp_images.length;a++){var o={url:e.storeData.tmp_images[a]};e.storeData.images.push(o)}for(var s=0;s<t.tempFilePaths.length;s++)e.$OBS.myUploadFile((new Date).getTime()+t.tempFiles[s].name,t.tempFilePaths[s],t.tempFiles[s].fileType,"se-store").then((function(t){console.log("success",t),e.storeData.tmp_images.push(t),e.storeData.images=[];for(var a=0;a<e.storeData.tmp_images.length;a++){var o={url:e.storeData.tmp_images[a]};e.storeData.images.push(o)}}))},selectAvatar:function(t){var e=this;console.log("选择图片",t),e.$OBS.myUploadFile((new Date).getTime()+t.tempFiles[0].name,t.tempFilePaths[0],t.tempFiles[0].fileType,"se-user-avatar").then((function(t){console.log("success",t),e.storeData.avatar=[];var a={url:t};e.storeData.avatar.push(a)}))},deleteImage:function(t){console.log(t),console.log(this.storeData.images);for(var e=0;e<this.storeData.tmp_images.length;e++)this.storeData.tmp_images[e]==t.tempFilePath&&this.storeData.tmp_images.splice(e,1)},changeCategory:function(){this.storeData.tmp_categoryList=[];for(var t=0;t<this.storeData.categoryList.length;t++)this.storeData.tmp_categoryList.push(this.categoryLists[this.storeData.categoryList[t]].text)}}};e.default=a}).call(this,a("543d")["default"])},b681:function(t,e,a){"use strict";var o=a("565c"),s=a.n(o);s.a},d6e9:function(t,e,a){"use strict";a.r(e);var o=a("5c11"),s=a.n(o);for(var n in o)"default"!==n&&function(t){a.d(e,t,(function(){return o[t]}))}(n);e["default"]=s.a},fa45:function(t,e,a){"use strict";a.d(e,"b",(function(){return s})),a.d(e,"c",(function(){return n})),a.d(e,"a",(function(){return o}));var o={uniForms:function(){return Promise.all([a.e("common/vendor"),a.e("uni_modules/uni-forms/components/uni-forms/uni-forms")]).then(a.bind(null,"9d30"))},uniSection:function(){return a.e("components/uni-section/uni-section").then(a.bind(null,"b506"))},uniFormsItem:function(){return Promise.all([a.e("common/vendor"),a.e("uni_modules/uni-forms/components/uni-forms-item/uni-forms-item")]).then(a.bind(null,"b4d1"))},uniEasyinput:function(){return a.e("uni_modules/uni-easyinput/components/uni-easyinput/uni-easyinput").then(a.bind(null,"8b0a"))},uniDataCheckbox:function(){return Promise.all([a.e("common/vendor"),a.e("uni_modules/uni-data-checkbox/components/uni-data-checkbox/uni-data-checkbox")]).then(a.bind(null,"8711"))},uniCombox:function(){return a.e("uni_modules/uni-combox/components/uni-combox/uni-combox").then(a.bind(null,"e3a9"))},uniFilePicker:function(){return Promise.all([a.e("common/vendor"),a.e("uni_modules/uni-file-picker/components/uni-file-picker/uni-file-picker")]).then(a.bind(null,"cc85"))}},s=function(){var t=this,e=t.$createElement;t._self._c},n=[]}},[["57e8","common/runtime","common/vendor"]]]);