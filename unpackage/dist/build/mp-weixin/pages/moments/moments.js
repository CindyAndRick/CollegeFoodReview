(global["webpackJsonp"]=global["webpackJsonp"]||[]).push([["pages/moments/moments"],{"09cc":function(e,t,n){"use strict";n.r(t);var o=n("89b4"),i=n.n(o);for(var c in o)"default"!==c&&function(e){n.d(t,e,(function(){return o[e]}))}(c);t["default"]=i.a},"2f0a":function(e,t,n){"use strict";n.d(t,"b",(function(){return i})),n.d(t,"c",(function(){return c})),n.d(t,"a",(function(){return o}));var o={uniCard:function(){return n.e("uni_modules/uni-card/components/uni-card/uni-card").then(n.bind(null,"1a0f"))},uniIcons:function(){return Promise.all([n.e("common/vendor"),n.e("uni_modules/uni-icons/components/uni-icons/uni-icons")]).then(n.bind(null,"d7ac"))},commentInput:function(){return n.e("uni_modules/qizai9527-input-comment/components/commentInput/commentInput").then(n.bind(null,"1abf"))},lbTabbar:function(){return Promise.all([n.e("common/vendor"),n.e("components/lb-tabbar/lb-tabbar")]).then(n.bind(null,"b226"))},lbTabbarItem:function(){return Promise.all([n.e("common/vendor"),n.e("components/lb-tabbar/lb-tabbar-item")]).then(n.bind(null,"26a2"))}},i=function(){var e=this,t=e.$createElement,n=(e._self._c,e.__map(e.commentList,(function(t,n){var o=e.__get_orig(t),i=e.getTime(t.time);return{$orig:o,m0:i}})));e.$mp.data=Object.assign({},{$root:{l0:n}})},c=[]},4643:function(e,t,n){"use strict";var o=n("831d"),i=n.n(o);i.a},"831d":function(e,t,n){},"89b4":function(e,t,n){"use strict";(function(e){Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var n={data:function(){return{userInfo:{},myId:"",commentList:[],isShowComment:!1,placeholder:"发个友善的评论吧",tmpCommentData:[],curCommentId:"",curtoId:"",active:"",animate:"zoomIn",height:"",tabbarHeight:"",tabbar_user:[{name:"index",text:"首页",icon:"../../static/icons/rank.png"},{name:"moments",text:"动态",icon:"../../static/icons/explore-active.png"},{name:"message",text:"消息",icon:"../../static/icons/message.png"},{name:"home",text:"我的",icon:"../../static/icons/homepage.png"}]}},onShow:function(){wx.hideHomeButton()},onLoad:function(){var t=this;e.getStorage({key:"userInfo",success:function(e){t.userInfo=e.data,t.myId=e.data.id,t.refresh()}})},methods:{checkTime:function(e){return e<10&&(e="0"+e),e},getTime:function(e){console.log(e);var t=new Date(1*e);console.log(t);var n=t.getFullYear(),o=t.getMonth()+1,i=t.getDate(),c=(t.getDay(),t.getHours()),s=t.getMinutes(),a=t.getSeconds();c=this.checkTime(c),s=this.checkTime(s),a=this.checkTime(a);return n+"-"+o+"-"+i+" "+c+":"+s+":"+a},refresh:function(){var t=this;e.request({url:"http://124.71.170.100/index.php/index/getAllComment",method:"GET",data:{id:this.myId},success:function(e){console.log("获取评论成功"),console.log(e),t.commentList=e.data.data.commentList},fail:function(){console.log("获取评论失败")}})},toHomePage:function(t){var n;console.log("Id:"+t),e.request({url:"http://124.71.170.100/index.php/index/getUserIdentity",method:"GET",data:{id:t},success:function(o){console.log(o),n=o.data.data.identity,console.log(n),"1"==n?e.navigateTo({url:"/pages/home/homepage?id="+t}):"2"==n?e.navigateTo({url:"/pages/index/store?id="+t}):"0"==n&&e.showToast({title:"此用户为管理员",icon:"none",duration:1500})},fail:function(){console.log("获取身份失败")}})},dishClick:function(t){e.navigateTo({url:"/pages/index/dish?dishId="+this.commentList[t].dishId+"&isCanteen="+this.commentList[t].isCanteen})},onClick:function(t,n){"title"==t&&(console.log(this.commentList[n].nickName+"被点击了"),e.navigateTo({url:"/pages/home/homepage?id="+this.commentList[n].userId}))},hasLikedClick:function(t){this.commentList[t].isLiked=0,this.commentList[t].likedNum--,e.request({url:"http://124.71.170.100/index.php/index/likeComment",method:"POST",header:{"content-type":"application/w-xxx-form-unlencoded"},data:{commentId:this.commentList[t].commentId,id:this.myId},success:function(){console.log("取消点赞")}})},likedClick:function(t){this.commentList[t].isLiked=1,this.commentList[t].likedNum++,e.request({url:"http://124.71.170.100/index.php/index/likeComment",method:"POST",header:{"content-type":"application/w-xxx-form-unlencoded"},data:{commentId:this.commentList[t].commentId,id:this.myId},success:function(){console.log("点赞成功")}})},clickComment:function(e,t){this.isShowComment=!0,this.curCommentId=e,this.curtoId=t},submitComment:function(t){var n=this;e.request({url:"http://124.71.170.100/index.php/index/replyToComment",method:"POST",header:{"content-type":"application/json"},data:{commentId:this.curCommentId,fromId:this.myId,detail:t,toId:this.curtoId},success:function(){console.log(n.curCommentId),console.log(n.myId),console.log(t),console.log(n.curtoId),n.isShowComment=!1,n.refresh()}})},clickOther:function(e){this.isShowComment=!1},tipofClick:function(t){console.log("举报"),e.navigateTo({url:"/pages/home/tip-of-comment?commentId="+this.commentList[t].commentId+"&id="+this.commentList[t].userId})},deleteClick:function(t){var n=this;e.showModal({title:"确认撤回该评论？",success:function(o){o.confirm?(e.request({url:"http://124.71.170.100/index.php/index/deleteComment",method:"POST",header:{"content-type":"application/x-www-form-urlencoded"},data:{commentId:n.commentList[t].commentId,id:n.myId},success:function(){console.log("删除成功,评论Id为"+n.commentList[t].commentId)}}),n.refresh()):o.cancel&&console.log("取消删除")}})},toSpecific:function(t){e.navigateTo({url:"/pages/index/comment?commentId="+this.commentList[t].commentId+"&isCanteen="+this.commentList[t].isCanteen})},handleChange:function(t){if(console.log("change::",t),1==this.userInfo.identity)switch(t.name){case"index":e.redirectTo({url:"/pages/index/index"});break;case"message":e.redirectTo({url:"/pages/message/message"});break;case"home":e.redirectTo({url:"/pages/home/my"});break;default:break}}}};t.default=n}).call(this,n("543d")["default"])},ae87:function(e,t,n){"use strict";(function(e){n("4a2a");o(n("66fd"));var t=o(n("b117"));function o(e){return e&&e.__esModule?e:{default:e}}wx.__webpack_require_UNI_MP_PLUGIN__=n,e(t.default)}).call(this,n("543d")["createPage"])},b117:function(e,t,n){"use strict";n.r(t);var o=n("2f0a"),i=n("09cc");for(var c in i)"default"!==c&&function(e){n.d(t,e,(function(){return i[e]}))}(c);n("4643");var s,a=n("f0c5"),m=Object(a["a"])(i["default"],o["b"],o["c"],!1,null,null,null,!1,o["a"],s);t["default"]=m.exports}},[["ae87","common/runtime","common/vendor"]]]);